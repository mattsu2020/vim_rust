#! /bin/sh
# run the automatically generated configure script
# This wrapper also forwards language interface selections to cargo via
# the VIM_CARGO_FEATURES environment variable.

FEATURES=""
CONFIG_ARGS=""

for arg in "$@"; do
  case "$arg" in
    --enable-lua) FEATURES="$FEATURES lua" ;;
    --enable-ruby) FEATURES="$FEATURES ruby" ;;
    --enable-perl) FEATURES="$FEATURES perl" ;;
    --enable-tcl) FEATURES="$FEATURES tcl" ;;
    --enable-mzscheme) FEATURES="$FEATURES mzsch" ;;
    --enable-xcmdsrv) FEATURES="$FEATURES xcmdsrv" ;;
    --enable-ole) FEATURES="$FEATURES ole" ;;
    *) CONFIG_ARGS="$CONFIG_ARGS \"$arg\"" ;;
  esac
done

export VIM_CARGO_FEATURES="$VIM_CARGO_FEATURES $FEATURES"

# shellcheck disable=SC2086
CONFIG_STATUS=auto/config.status \
        auto/configure $CONFIG_ARGS --srcdir="${srcdir:-.}" --cache-file=auto/config.cache
result=$?

# Stupid autoconf 2.5x causes this file to be left behind.
if test -f configure.lineno; then rm -f configure.lineno; fi

exit $result
